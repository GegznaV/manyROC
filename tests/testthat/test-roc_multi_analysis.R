context("roc_multi_analysis")
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
test_that("works with vector input", {
  data(PlantGrowth)

    res <- roc_multi_analysis(PlantGrowth$weight,
                              PlantGrowth$group)

    expect_s3_class(res, "data.frame")

    expect_equal(nrow(res), 3)
    expect_equal(ncol(res), 15)

    # Two factor levels:
    expect_s3_class(roc_multi_analysis(1:10, gl(2, 2, 10)), "data.frame")
    expect_s3_class(roc_multi_analysis(1:10, gl(2, 2, 10),
                                       optimize_by = "kappa"),
                    "data.frame")
})
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
test_that("works with data.frame input" , {
    data(CO2)
    res <- roc_multi_analysis(CO2[, c("conc", "uptake")], CO2$Type)

    expect_s3_class(res, "data.frame")
    expect_equal(nrow(res), 2)
    expect_equal(ncol(res), 15)
})
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
test_that("works with hyperSpec input", {
    res <- roc_multi_analysis(fluorescence[ , , 500~502],
                              fluorescence$gr)
    expect_s3_class(res, "data.frame")
    expect_equal(ncol(res), 15)
})
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
test_that("robust to incorrect inputinput", {
    x1 <-
    expect_error(roc_multi_analysis("a", "a"))
    expect_error(roc_multi_analysis(1, "a"))
    expect_error(roc_multi_analysis(1, 1))
    # Lengths differ:
    expect_error(roc_multi_analysis(1:10, gl(2, 2, 5)))
    # Too few factor levels:
    expect_error(roc_multi_analysis(1:10, gl(1, 2, 10)))
})
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~